# ุชูุฑูุฑ ูููุทูุฑ - ุฅุตูุงุญ ูุดููุฉ ุงููุฆุงุช ุงูุนุฑุจูุฉ
**ุงูุชุงุฑูุฎ:** 2026-01-08
**ุงูุญุงูุฉ:** โ ุชู ุงูุฅุตูุงุญ ูุงูุงุฎุชุจุงุฑ

---

## ๐ ููุฎุต ุงููุดููุฉ

### ุงููุดููุฉ ุงูุฃุตููุฉ:
ุนูุฏ ุฅุถุงูุฉ ูุฆุงุช ุฌุฏูุฏุฉ ุจุฃุณูุงุก ุนุฑุจูุฉ ูู ููุญุฉ ุงูุชุญููุ ูุงูุช ุชุธูุฑ ุฑุณุงูุฉ ุฎุทุฃ:
```
Category name or slug already exists
```

### ุงูุณุจุจ:
ุงููุธุงู ูุงู ูุญุฐู ุฌููุน ุงูุฃุญุฑู ุงูุนุฑุจูุฉ ุนูุฏ ุฅูุดุงุก ุงูู slugุ ููุง ููุชุฌ ุนูู slug ูุงุฑุบ ุฃู "-"ุ ููุฐุง ูุชุนุงุฑุถ ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุชู ุชููุน ุงูุชูุฑุงุฑ.

---

## โ ูุง ุชู ุฅุตูุงุญู

### 1. ุฏุนู ุงูุฃุญุฑู ุงูุนุฑุจูุฉ ูู ุงูู Slugs
**ุงูููู:** `backend/models/Category.js`

**ุงูุชุบููุฑุงุช:**
- ุฅุถุงูุฉ ุฏุงูุฉ `createSlug()` ุชุฏุนู ุงูุฃุญุฑู ุงูุนุฑุจูุฉ (Unicode: U+0600-U+06FF)
- ุฎุฑูุทุฉ ุชุฑุฌูุฉ ูููููุงุช ุงูุดุงุฆุนุฉ (ุทุจูุนุฉ โ natureุ ุชุตููู โ designุ ุฅูุฎ)
- ุงูุญูุงุธ ุนูู ุงูุฃุญุฑู ุงูุนุฑุจูุฉ ูู ุงูู slug ุจุฏูุงู ูู ุญุฐููุง

**ูุซุงู:**
| ุงุณู ุงููุฆุฉ | Slug ุงููุงุชุฌ |
|-----------|-------------|
| ุชุตููู | design (ูู ุฎุฑูุทุฉ ุงูุชุฑุฌูุฉ) |
| ุฎูููุงุช ุฅุณูุงููุฉ | ุฎูููุงุช-ุฅุณูุงููุฉ (ูุญุชูุธ ุจุงูุนุฑุจูุฉ) |
| ุฑูุงุถุฉ | sports (ูู ุฎุฑูุทุฉ ุงูุชุฑุฌูุฉ) |

### 2. ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ
**ุงูููู:** `backend/controllers/categoryController.js`

**ุงูุชุบููุฑุงุช:**
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ
- ุชุญุฏูุฏ ุฏููู ููุญูู ุงูููุฑุฑ (name ุฃู slug)
- ูุนุงูุฌุฉ ุฃูุถู ูุฎุทุฃ duplicate key (error code 11000)

**ุฑุณุงุฆู ุงูุฎุทุฃ ุงูุฌุฏูุฏุฉ:**
```javascript
โ "ูุฆุฉ ุจูุฐุง ุงูุงุณู ููุฌูุฏุฉ ูุณุจูุงู" - ุฅุฐุง ูุงู ุงูุงุณู ููุฑุฑ
โ "ูุฆุฉ ุจูุฐุง ุงูุฑุงุจุท (slug) ููุฌูุฏุฉ ูุณุจูุงู. ูุฑุฌู ุงุฎุชูุงุฑ ุงุณู ูุฎุชูู" - ุฅุฐุง ูุงู ุงูู slug ููุฑุฑ
โ "ุชู ุฅูุดุงุก ุงููุฆุฉ ุจูุฌุงุญ" - ุนูุฏ ุงููุฌุงุญ
```

### 3. ุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช
ุชู ุชุญุฏูุซ ุฌููุน ุงููุฆุงุช ุงููุฏููุฉ ุฐุงุช ุงูู slugs ุงูุบูุฑ ุตุญูุญุฉ:

| ุงุณู ุงููุฆุฉ | Slug ุงููุฏูู | Slug ุงูุฌุฏูุฏ | ุงูุญุงูุฉ |
|-----------|--------------|-------------|--------|
| ุฑูุงุถุฉ | "" (ูุงุฑุบ) | sports | โ ุชู |
| ุฎูููุงุช ูููุนุฉ | "-" | ุฎูููุงุช-ูููุนุฉ | โ ุชู |
| ุฎูููุงุช ุฏูููุฉ | "-" | ุฎูููุงุช-ุฏูููุฉ | โ ุชู |
| ููุงููุฉ | "" (ูุงุฑุบ) | ููุงููุฉ | โ ุชู |
| ุฎูููุงุช ุณุนูุฏูุฉ | "-" | ุฎูููุงุช-ุณุนูุฏูุฉ | โ ุชู |

---

## ๐ฏ ูุง ูุฌุจ ุฃู ูุนูู ุงูุขู ูู ุงูุชุทุจูู

### โ ุงููุฆุงุช (Categories)

#### 1. ุฌูุจ ุฌููุน ุงููุฆุงุช ุงููุดุทุฉ
```http
GET /api/categories/active
```
**ุงูุงุณุชุฎุฏุงู:** ูุนุฑุถ ูุงุฆูุฉ ุงููุฆุงุช ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
**ุงูุญุงูุฉ:** โ ูุนูู ุจุดูู ุตุญูุญ

#### 2. ุฌูุจ ูุฆุฉ ุจูุงุณุทุฉ ุงูู slug
```http
GET /api/categories/slug/:slug
```
**ุงูุฃูุซูุฉ:**
- `GET /api/categories/slug/sports` โ ูุฆุฉ "ุฑูุงุถุฉ"
- `GET /api/categories/slug/ุฎูููุงุช-ูููุนุฉ` โ ูุฆุฉ "ุฎูููุงุช ูููุนุฉ"

**ุงูุญุงูุฉ:** โ ูุนูู ุจุดูู ุตุญูุญ

#### 3. ุฅุถุงูุฉ ูุฆุฉ ุฌุฏูุฏุฉ (Admin ููุท)
```http
POST /api/categories
Content-Type: application/json
Authorization: Bearer {token}

{
  "name": "ูุฆุฉ ุฌุฏูุฏุฉ",
  "description": "ูุตู ุงููุฆุฉ",
  "isActive": true
}
```
**ุงูุญุงูุฉ:** โ ูุนูู - ูููุฏ slug ุตุญูุญ ุชููุงุฆูุงู

---

## ๐ด ููุงุญุธุงุช ูููุฉ ููุชุทุจูู

### 1. ุงุณุชุฎุฏุงู ุงูู Slugs ูู ุงูู URLs
ุงูุขู ุงูู slugs ูููู ุฃู ุชุญุชูู ุนูู ุฃุญุฑู ุนุฑุจูุฉ. ุชุฃูุฏ ูู:

```swift
// โ ุตุญูุญ - encode URL
let slug = category.slug.addingPercentEncoding(withAllowedCharacters: .urlPathAllowed)
let url = "https://khalafiati.com/api/categories/slug/\(slug!)"

// โ ุฎุทุฃ - ุจุฏูู encoding
let url = "https://khalafiati.com/api/categories/slug/\(category.slug)"
```

### 2. ุนุฑุถ ุฃุณูุงุก ุงููุฆุงุช
ุงูุฃุณูุงุก ุงูุนุฑุจูุฉ ุชุนูู ุจุดูู ุทุจูุนูุ ูุง ุญุงุฌุฉ ูุชุนุฏููุงุช ูู ุงูุชุทุจูู.

### 3. ุชุฎุฒูู ุงููุฆุงุช ูุญููุงู (Cache)
ุฅุฐุง ููุช ุชุฎุฒู ุงููุฆุงุช ูู Core Data ุฃู UserDefaultsุ ุชุฃูุฏ ูู:
- ุญูุธ ุงูู `slug` ููุง ูู (ุจุงูุนุฑุจูุฉ ุฃู ุงูุฅูุฌููุฒูุฉ)
- ุงุณุชุฎุฏุงู `slug` ููููุงุฑูุฉ ุจุฏูุงู ูู `name`

---

## ๐ ุงููุฆุงุช ุงูุญุงููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

| # | ุงุณู ุงููุฆุฉ | Slug | ุนุฏุฏ ุงูุตูุฑ | ุงูุญุงูุฉ |
|---|-----------|------|-----------|--------|
| 1 | ุฑูุงุถุฉ | sports | 3 | ูุดุท |
| 2 | ุฎูููุงุช ูููุนุฉ | ุฎูููุงุช-ูููุนุฉ | 9 | ูุดุท |
| 3 | ุฎูููุงุช ุฏูููุฉ | ุฎูููุงุช-ุฏูููุฉ | 2 | ูุดุท |
| 4 | ููุงููุฉ | ููุงููุฉ | 4 | ูุดุท |
| 5 | ุฎูููุงุช ุณุนูุฏูุฉ | ุฎูููุงุช-ุณุนูุฏูุฉ | 8 | ูุดุท |

**ุงููุฌููุน:** 5 ูุฆุงุช ูุดุทุฉุ 26 ุตูุฑุฉ

---

## ๐งช ุงุฎุชุจุงุฑุงุช ููููู ุฅุฌุฑุงุคูุง

### ุงุฎุชุจุงุฑ 1: ุฌูุจ ุงููุฆุงุช
```bash
curl https://khalafiati.com/api/categories/active
```
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** JSON ูุญุชูู ุนูู 5 ูุฆุงุช

### ุงุฎุชุจุงุฑ 2: ุฌูุจ ูุฆุฉ ูุนููุฉ
```bash
curl https://khalafiati.com/api/categories/slug/sports
```
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ุจูุงูุงุช ูุฆุฉ "ุฑูุงุถุฉ" ูุน ุงูุตูุฑ

### ุงุฎุชุจุงุฑ 3: ุฌูุจ ูุฆุฉ ุนุฑุจูุฉ
```bash
curl "https://khalafiati.com/api/categories/slug/ุฎูููุงุช-ูููุนุฉ"
```
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ุจูุงูุงุช ูุฆุฉ "ุฎูููุงุช ูููุนุฉ" ูุน ุงูุตูุฑ

---

## โ๏ธ ูุดุงูู ูุญุชููุฉ ูู ุงูุชุทุจูู

### 1. URL Encoding ููุฃุญุฑู ุงูุนุฑุจูุฉ
**ุงููุดููุฉ:** ุฅุฐุง ููุช ุชุณุชุฎุฏู slug ุนุฑุจู ูู URL ุจุฏูู encoding
**ุงูุญู:**
```swift
// Swift
let encodedSlug = slug.addingPercentEncoding(withAllowedCharacters: .urlPathAllowed)

// ุฃู ุงุณุชุฎุฏู URLComponents
var components = URLComponents()
components.scheme = "https"
components.host = "khalafiati.com"
components.path = "/api/categories/slug/\(slug)"
```

### 2. ุนุฑุถ ุงููุฆุงุช ูู TableView
**ูุง ููุฌุฏ ุชุบููุฑ!** ุงุณุชุฎุฏู `category.name` ููุง ููุช ุชูุนู

### 3. ุงูุชููู ุจูู ุงููุฆุงุช
**ุงุณุชุฎุฏู:** `category.slug` ููุชูููุ ูููุณ `category.name`

```swift
// โ ุตุญูุญ
let slug = category.slug
fetchImages(forCategorySlug: slug)

// โ ุฎุทุฃ - ุงูุงุณู ูุฏ ูุชุบูุฑ
let name = category.name
fetchImages(forCategoryName: name)
```

---

## ๐ฆ ุงูุชุญุฏูุซุงุช ุนูู GitHub

ุฌููุน ุงูุชุญุฏูุซุงุช ุชู ุฑูุนูุง ุฅูู:
**Repository:** https://github.com/kaebs19/KhalafiatiWeb

**Commits:**
1. `Fix Arabic category slug generation and duplicate detection`
2. `Add documentation for Arabic category fixes`

---

## ๐ง ูููุทูุฑูู ุงูุขุฎุฑูู

ุฅุฐุง ูุงู ููุงู ูุทูุฑูู ุขุฎุฑูู ูุนูููู ุนูู Backend:

### ุณุญุจ ุงูุชุญุฏูุซุงุช:
```bash
git pull origin main
cd backend
npm install  # ุฅุฐุง ูุงู ููุงู dependencies ุฌุฏูุฏุฉ
```

### ุงููููุงุช ุงููุนุฏูุฉ:
- `backend/models/Category.js` (ุงูุณุทูุฑ 42-96)
- `backend/controllers/categoryController.js` (ุฏูุงู create ู update)

### ุฅุนุงุฏุฉ ุชุดุบูู Backend ูุญููุงู:
```bash
cd backend
npm start
```

---

## โ ุงูุฎูุงุตุฉ

| ุงูููุฒุฉ | ุงูุญุงูุฉ | ููุงุญุธุงุช |
|--------|--------|---------|
| ุฅุถุงูุฉ ูุฆุงุช ุนุฑุจูุฉ | โ ูุนูู | ูููุฏ slug ุตุญูุญ ุชููุงุฆูุงู |
| ุฌูุจ ุงููุฆุงุช | โ ูุนูู | ุฌููุน ุงูู endpoints ุชุนูู |
| Slugs ุงูุนุฑุจูุฉ | โ ูุฏุนููุฉ | ุชุฐูุฑ URL encoding ูู ุงูุชุทุจูู |
| ุฑุณุงุฆู ุงูุฎุทุฃ | โ ูุญุฏุซุฉ | ุงูุขู ุจุงูุนุฑุจูุฉ ููุงุถุญุฉ |
| ูุงุนุฏุฉ ุงูุจูุงูุงุช | โ ูุธููุฉ | ูุง ุชูุฌุฏ slugs ูุงุฑุบุฉ |

---

## ๐ ุฅุฐุง ูุงุฌูุช ูุดุงูู

### ูุดููุฉ: ูุง ุชุธูุฑ ุงููุฆุงุช ูู ุงูุชุทุจูู
**ุงูุญู:**
1. ุชุญูู ูู ุงูู endpoint: `GET /api/categories/active`
2. ุชุญูู ูู ุงูู response status code (ูุฌุจ ุฃู ูููู 200)

### ูุดููุฉ: ุฎุทุฃ ุนูุฏ ูุชุญ ูุฆุฉ ูุนููุฉ
**ุงูุญู:**
1. ุชุญูู ูู URL encoding ููู slug
2. ุงุณุชุฎุฏู `addingPercentEncoding` ูู Swift

### ูุดููุฉ: ูุง ูููู ุฅุถุงูุฉ ูุฆุฉ ุฌุฏูุฏุฉ ูู ููุญุฉ ุงูุชุญูู
**ุงูุญู:**
1. ุชุญูู ูู ุงูู token ูู Authorization header
2. ุชุญูู ูู ุฃู ุงููุณุชุฎุฏู ูุฏูู ุตูุงุญูุฉ admin

---

**ุชู ุงูุชุญุฏูุซ:** 2026-01-08
**ุงูุญุงูุฉ ุงูููุงุฆูุฉ:** โ ุฌููุน ุงูุฅุตูุงุญุงุช ููุชููุฉ ููุฎุชุจุฑุฉ
